<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NC RO Gen Service</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- SweetAlert2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">

    <link rel="stylesheet" href="/css/common.css">

    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css">

    <!-- jQuery (required by DataTables) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>

</head>

<body>
<!-- Header Section -->
<header class="bg-primary text-white py-3">
    <div class="container d-flex justify-content-between align-items-center">
        <img src="/images/gc.png" alt="Left Logo" class="img-fluid" style="max-height: 50px;">
        <h1 class="text-center mb-0">NC RO GENERATION SERVICE</h1>
        <img src="/images/nc.png" alt="Right Logo" class="img-fluid" style="max-height: 50px;">
    </div>
</header>

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-secondary">
    <div class="container">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav nav-tabs" role="tablist">
                <li class="nav-item">
                    <a class="nav-link text-dark active" data-bs-toggle="tab" href="#uploadRates" role="tab">Upload New Master Rates</a>
                </li>

                <!-- Navigation Tab for "View Master" -->
                <li class="nav-item">
                    <a class="nav-link text-dark" id="viewMasterTab" data-bs-toggle="tab" href="#viewRates" role="tab">View Master</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-dark" data-bs-toggle="tab" href="#createRo" role="tab">Create RO</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-dark" id="previewRoTab" data-bs-toggle="tab" href="#previewRo" role="tab">Preview RO</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-dark" data-bs-toggle="tab" href="#addClient" role="tab">Add Client</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-dark" data-bs-toggle="tab" href="#generateRO" role="tab">Generate RO For Release</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-dark" data-bs-toggle="tab" href="#services" role="tab">Services</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link text-dark" data-bs-toggle="tab" href="#contact" role="tab">Contact</a>
                </li>

            </ul>
        </div>
    </div>
</nav>

<!-- Tab Content -->
<div class="container-fluid mt-4">
    <div class="tab-content">

        <!-- Upload New Master Rates Tab (Completed Not To Be Changes Done AnyMore)-->
        <div class="tab-pane fade show active" id="uploadRates" role="tabpanel">
            <h2>Upload New Master Rates</h2>
            <p>This is where you can upload new master rates for your service.</p>
            <form id="fileUploadForm" class="mb-4">
                <div class="mb-3">
                    <label for="fileInput" class="form-label">Upload File (.csv, .xls, .xlsx):</label>
                    <input type="file" id="fileInput" class="form-control" accept=".csv, .xls, .xlsx" required>
                </div>
                <button type="submit" class="btn btn-primary">Upload and Display</button>
            </form>

            <!-- Display File Content -->
            <div id="fileContent" class="table-responsive">
                <table class="table table-sm table-bordered table-responsive" id="dataTable">
                    <thead></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- View Master Content -->
        <div class="tab-pane fade" id="viewRates" role="tabpanel">
            <div class="container-fluid">
                <h2>View Master</h2>
                <!-- Table (Initially hidden) -->
                <div class="card">
                    <div class="card-header">
                        Master Details
                    </div>
                    <div class="card-body">
                        <div id="tableContainer" style="overflow-x: auto; display: none;">
                            <table class="table table-sm table-responsive table-bordered table-striped" style="width: 100%;" id="newspapersTable">
                                <thead>
                                <tr>
                                    <th>News Paper Code</th>
                                    <th>News Paper Name</th>
                                    <th>Last Renewed Date</th>
                                    <th>State</th>
                                    <th>Place Of Publication</th>
                                    <th>Language</th>
                                    <th>Periodicity</th>
                                    <th>Category</th>
                                    <th>Regularity Status</th>
                                    <th>Circulation Base</th>
                                    <th>Circulation</th>
                                    <th>Rate</th>
                                </tr>
                                </thead>
                                <tbody id="viewTable">
                                <!-- Data will be filled here dynamically -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Ro-->
        <div class="tab-pane fade" id="createRo" role="tabpanel">
            <div class="container-fluid">
                <h2>Create RO</h2>
                <div  >
                    <div class="container-fluid">
                        <form>
                            <div class="row">
                                <!-- DAV (Hidden Field) -->
                                <div class="col-md-3 mb-3" >
                                    <div class="input-group">
                                        <span class="input-group-text">Dav</span>
                                        <input type="text" class="form-control uppercase" name="dav" id="dav" placeholder="Data will Pre Filled" readonly required>
                                    </div>
                                </div>

                                <!-- Client Name -->
                                <div class="col-md-3 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">Client Name</span>
<!--                                        <input type="text" class="form-control uppercase" name="clientName" id="clientName" required>-->
                                        <select class="form-select" name="clientName" id="clientName" required>
                                            <option value="" selected disabled>Select Newspaper</option>
                                            <option th:each="name : ${clientList}" th:value="${name}" th:text="${name}"></option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Page Number -->
                                <div class="col-md-3 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">Page Number</span>
                                        <input type="text" class="form-control" name="pageNumber" id="pageNumber" required>
                                    </div>
                                </div>

                                <!-- Newspaper Name -->
                                <div class="col-md-3 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">Newspaper Name</span>
                                        <select class="form-select" name="newspaperName" id="newspaperName" required onchange="fetchStates();fetchPublicationName();fetchLanguage();fetchPeriodicity();fetchCategory()">
                                            <option value="" selected disabled>Select Newspaper</option>
                                            <option th:each="name : ${newsPaperName}" th:value="${name}" th:text="${name}"></option>
                                        </select>
                                    </div>
                                </div>

                                <!-- State -->
                                <div class="col-md-3 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">State</span>
                                        <select class="form-select" required name="state" onchange="fetchPublicationName()" id="stateDropdown">
                                            <option value="" selected disabled>Select State</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Edition -->
                                <div class="col-md-3 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">Edition</span>
                                        <select class="form-select" required name="placeOfPublication" id="placeOfPublication" onchange="fetchLanguage()">
                                            <option value="" selected disabled>Select Edition</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Language -->
                                <div class="col-md-3 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">Language</span>
                                        <select class="form-select" required name="language" id="language">
                                            <option value="" selected disabled>Select Language</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Colour -->
                                <div class="col-md-3 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">Colour</span>
                                        <select class="form-select" required name="color" id="color">
                                            <option value="" selected disabled>Select Color</option>
                                            <option value="B/W">B/W</option>
                                            <option value="Color">Color</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- GST -->
                                <div class="col-md-3 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">GST Applicable</span>
                                        <select class="form-select" required name="gstType" id="gstType">
                                            <option value="" selected disabled>Select GST</option>
                                            <option value="IGST">IGST</option>
                                            <option value="CGST">CGST</option>
                                        </select>
                                    </div>
                                </div>


                                    <div class="col-md-3 mb-3" id="periodicityDropDown" style="display: none ">
                                        <div class="input-group highlight">
                                            <span class="input-group-text highlight">Periodicity</span>
                                            <select class="form-select highlight" required name="periodicity" id="periodicity" onchange="fetchCategory()">
                                                <option value="" selected disabled>Select Periodicity</option>

                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-md-3 mb-3" id="categoryDropDown" style="display: none ">
                                        <div class="input-group highlight" >
                                            <span class="input-group-text highlight" >Category</span>
                                            <select class="form-select highlight" required name="category" id="category">
                                                <option value="" selected disabled>Select Category</option>

                                            </select>
                                        </div>
                                    </div>


                                <!-- Date -->
                                <div class="col-md-3 mb-3" >
                                    <div class="input-group">
                                        <span class="input-group-text">Date</span>
                                        <input type="date" class="form-control" id="dateInput" name="date" />
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>

                    <table class="table table-sm table-responsive table-bordered" style="width: 100% !important;">
                        <thead>
                        <tr>

                            <th rowspan="2">Action</th>
                            <th rowspan="2">Submission Date</th>
                            <th rowspan="2">Client Name</th>
                            <th rowspan="2">Page Number</th>
                            <th rowspan="2">Newspaper Name</th>
                            <th rowspan="2">State</th>
                            <th rowspan="2">Edition</th>
                            <th rowspan="2">DAVP Rates<br> per sq cm <br>in Rs</th>
                            <!--                            <th rowspan="2">Color</th>-->
                            <th rowspan="2" id="extraColumnHeader" style="display: none;">Colour <br>40% Extra</th>
                            <th rowspan="2">Language</th>


                            <th rowspan="2">RO Number</th>
                            <th rowspan="2">RO Date</th>
                            <th rowspan="2">Date of <br>publication</th>
                            <th colspan="2">Size</th>
                            <th rowspan="2">Size in <br>cm2</th>
                            <th rowspan="2">Total Amount <br>Rs</th>
                            <th rowspan="2">Price to <br>Newspaper </th>
                            <th rowspan="2">GST Amount</th>
                            <th rowspan="2">New Payable</th>
                            <th rowspan="2">Email id</th>
                            <th rowspan="2">Phone Number</th>



                        </tr>
                        <tr>
                            <th>Length <br>cm</th>
                            <th>Breadth <br>cm</th>

                        </tr>
                        </thead>
                        <tbody id="tableBody">
                        <!-- Rows will be dynamically added here -->
                        </tbody>
                    </table>
                    <button type="button" class="btn btn-primary mb-3" onclick="addRow()">Add Row</button>


                </div>
            </div>
        </div>

        <!-- Preview RO-->
        <div class="tab-pane fade" id="previewRo" role="tabpanel">
            <div class="container-fluid">
                <h2>Preview RO</h2>
                <div class="card">
                    <div class="card-header">
                        RO Details
                    </div>
                    <div class="card-body">
                        <div id="previewRoContainer" style="overflow-x: auto;">
                            <table class="table table-sm table-responsive table-bordered table-striped" id="previewRoTable" style="width: 100%;">
                                <thead>
                                <tr>
                                    <th>Action</th>
                                    <th>Submission Date</th>
                                    <th>Newspaper Name</th>
                                    <th>Client Name</th>
                                    <th>RO Date</th>
                                    <th>RO Number</th>
                                    <th>Date of Publication</th>
                                    <th>Page Number</th>
                                    <th>State</th>
                                    <th>Edition</th>
                                    <th>DAVP Rates per sq cm in Rs</th>
                                    <th>Colour 40% Extra</th>
                                    <th>Language</th>
                                    <th>Length (cm)</th>
                                    <th>Breadth (cm)</th>
                                    <th>Size in cm²</th>
                                    <th>Total Amount Rs</th>
                                    <th>Price to Newspaper</th>
                                    <th>GST Amount</th>
                                    <th>Net Payable</th>
                                    <th>Email ID</th>
                                    <th>Phone Number</th>
                                </tr>
                                </thead>
                                <tbody id="previewRoTbody">
                                <!-- Rows will be dynamically added here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Client-->
        <div class="tab-pane fade" id="addClient" role="tabpanel">
            <div class="container-fluid">
                <h2>Add Client</h2>
                <div>
                    <div class="container-fluid">
                        <form action="/addClient" method="POST" id="addClientForm">
                            <div class="row">
                                <!-- Client Name -->
                                <div class="col-md-3 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">Client Name</span>
                                        <input type="text" class="form-control uppercase" name="clientName" id="cName" required>
                                    </div>
                                </div>

                                <div class="col-md-3 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">Client Short Form</span>
                                        <input type="text" class="form-control uppercase" name="clientShortForm" id="cShort" required>
                                    </div>
                                </div>

                                <!-- Submit Button -->
                                <div class="col-md-3 mb-3">
                                    <button type="submit" id="submitBtn" class="btn btn-primary">Submit</button>
                                </div>
                            </div>
                        </form>

                        <table id="clientData" class="table table-bordered table-stripped table-responsive" style="width: 100% !important">
                            <thead>
                                <th>Client Name</th>
                                <th>Client ID</th>
                                <th>Action</th>
                            </thead>
                            <tbody>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Generate RO For Release Tab -->
        <div class="tab-pane fade" id="generateRO" role="tabpanel">
            <h2>Generate RO For Release</h2>
            <div class="row">

                <div class="col-md-3 mb-3" >
                    <div class="input-group">
                        <span class="input-group-text">Submission Date</span>
                        <input type="date" class="form-control" id="SubmissionDate" name="SubmissionDate" />
                    </div>
                </div>

                <div class="col-md-3 mb-3" >
                    <div class="input-group">
                        <span class="input-group-text">Client Name</span>
                        <input type="text" class="form-control" id="clientNameForGenerateRO" name="clientNameForGenerateRO" />
<!--                        <select class="form-select" name="clientNameForGenerateRO" id="clientNameForGenerateRO">-->
<!--                            <option value="" selected disabled>Select Client Name</option>-->
<!--                        </select>-->
                    </div>
                </div>

                <div class="col-md-3 mb-3" >
                    <div class="input-group">
                        <span class="input-group-text">RO Date</span>
                        <input type="text" class="form-control" id="roDateForGenrateRo" name="roDate" />
<!--                        <select class="form-select" name="roDate" id="roDateForGenrateRo">-->
<!--                            &lt;!&ndash;                            dynamically append client name from js &ndash;&gt;-->
<!--                        </select>-->
                    </div>
                </div>

                <div class="col-md-3 mb-3" >
                    <div class="input-group">
                        <span class="input-group-text">Newspaper Name</span>
                        <input type="text" class="form-control" id="newspaperNameForGenRo" name="newspaperNameForGenRo" />
<!--                        <select class="form-select" name="newspaperNameForGenRo" id="newspaperNameForGenRo">-->
<!--                            <option value="" selected disabled>Select Newspaper Name</option>-->
<!--                        </select>-->
                    </div>
                </div>

                <div class="col-md-3 mb-3" >
                    <div class="input-group">
                        <span class="input-group-text">Publish Date</span>
                        <input type="text" class="form-control" id="publishcationDate" name="publishcationDate" />
<!--                        <select class="form-select" name="publishcationDate" id="publishcationDate">-->
<!--                            &lt;!&ndash;                            dynamically append client name from js &ndash;&gt;-->
<!--                        </select>-->
                    </div>
                </div>

                <!-- GST -->
                <div class="col-md-3 mb-3">
                    <div class="input-group">
                        <span class="input-group-text">GST Applicable</span>
                        <select class="form-select" required name="generateGst" id="generateGst">
                            <option value="" selected disabled>Select GST</option>
                            <option value="IGST">IGST</option>
                            <option value="CGST">CGST</option>
                        </select>
                    </div>
                </div>
            </div>


            <button class="btn btn-primary" onclick="showRo()">Generate Ro</button>
            <button class="btn btn-primary" onclick="printPage()">Print Page</button>



            <div class="container-fluid my-4 p-3 shadow card" style="display: none" id="RoContainer">
                <!-- Header -->
                <div class="row">
                    <div class="col-6">
                        <div class="row">
                            <div class="col-6">
                                <h4>NEERAJ COMMUNICATION</h4>
                            </div>
                            <div class="col-6">
                                <p>(INS Accredited Agency)</p>
                            </div>
                        </div>
                        <p>9, Apex Chamber 19, Vidhan Sabha Marg, Lucknow-226001</p>
                        <p>Tele: 0522-4025804 | Mobile: 08318523654, 09838893800</p>
                        <p>Email: <a href="mailto:pankaj@neerajcommunication.com">pankaj@neerajcommunication.com</a></p>

                    </div>
                    <div class="col-6 d-flex justify-content-end w-50">
                        <table class="table details-table table-bordered w-50">
                            <thead>
                            <tr>
                                <th>PAN No</th>
                                <td>APJPP7180A</td>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <th>GST No</th>
                                <td>09APJPP7180A2ZQ</td>
                            </tr>
                            <tr>
                                <th>INS Code</th>
                                <td>11251</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <hr>

                <!-- Release Order Info -->
                <h2 class="text-center fw-bold text-decoration-underline">RELEASE ORDER</h2>
                <div class="col-6">
                    <div class="d-flex align-items-center justify-content-between w-50">
                        <div>
                            <h6>RO No.</h6>
                        </div>
                        <div>
                            <p id="genRoNumber"></p>
                        </div>
                    </div>
                    <div class="d-flex align-items-center justify-content-between w-50">
                        <div>
                            <h6>R.O. Date</h6>
                        </div>
                        <div>
                            <p id="clientRoDate"></p>
                        </div>
                    </div>
                    <div class="d-flex align-items-center justify-content-between w-50">
                        <div>
                            <h6>Publish Date</h6>
                        </div>
                        <div>
                            <p id="dateOfpublish"></p>
                        </div>
                    </div>
                    <div class="d-flex align-items-center justify-content-between w-50">
                        <div>
                            <h6>Client</h6>
                        </div>
                        <div>
                            <p id="roClientName">INFORMATION DEPARTMENT UP</p>
                        </div>
                    </div>
                    <div class="d-flex align-items-center justify-content-between w-50">
                        <div>
                            <h6>Page Position</h6>
                        </div>
                        <div>
                            <p id="pagePosition"></p>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col">
                        <table id="generateRoTable" class="table table-bordered">
                            <thead class="table-light">
                            <tr>
                                <th>Size in C.M.</th>
                                <th>Publication</th>
                                <th>Language</th>
                                <th>Edition</th>
                                <th>DAVP Rate per Sq Cm (in Rs.)</th>
                                <th>Colour 40% Extra</th>
                                <th>Size in Sq Cm</th>
                                <th>Total Amount (in Rs.)</th>
                            </tr>
                            </thead>
                            <tbody>



                            </tbody>
                            <tbody>
                            <!-- Financial Details -->
                            <tr>
                                <td colspan="5"></td>
                                <th colspan="2" class="text-center">Amount</th>
                                <td id="finTotalAmount"> </td>
                            </tr>
                            <tr>
                                <td colspan="5"></td>
                                <th colspan="2" class="text-center">Agency Comm. 15%</th>
                                <td id="finAgencyCommission"> </td>
                            </tr>
                            <tr>
                                <td colspan="5"></td>
                                <th colspan="2" class="text-center">Taxable Amount</th>
                                <td id="finPaperPublisihAmount"> </td>
                            </tr>
                            <tr id="cgst1">
                                <td colspan="5"></td>
                                <th colspan="2" class="text-center">CGST 2.5%</th>
                                <td id="finCgst"> </td>
                            </tr>
                            <tr id="cgst2">
                                <td colspan="5"></td>
                                <th colspan="2" class="text-center" >SGST 2.5%</th>
                                <td id="finSgst"> </td>
                            </tr>

                            <tr id="Icgst">
                                <td colspan="5"></td>
                                <th colspan="2" class="text-center" >ICGST 5%</th>
                                <td id="finicgst"> </td>
                            </tr>
                            <tr>
                                <td colspan="5"></td>
                                <th colspan="2" class="text-center">Net Total (Round Off)</th>
                                <td id="finTotalPayAbleAmount"> </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>



                <!-- Notes -->
                <div class="row">
                    <div class="col-6">
                        <div class="row notes">
                            <div class="col">
                                <p><strong>Note:</strong></p>
                                <ol>
                                    <li>The newspaper advertisement should be printed on the publish date newspaper.</li>
                                    <li>The creative of the given size is attached within the email. If not, then please let us know immediately.</li>
                                    <li>The advertisement design should be printed exactly as given in the creative PDF.</li>
                                    <li>If the advertisement size, colour, or quality is not up to the mark, it will affect the payment.</li>
                                    <li>The advertisement should also be released in the Dark Edition.</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <!-- Footer -->
                        <div class="row">
                            <div class="col">
                                <p><strong>For Neeraj Communication</strong></p>
                                <div class="rectangle-container">
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </div>

        <!-- Services Tab -->
        <div class="tab-pane fade" id="services" role="tabpanel">
            <h2>Services</h2>
            <p>Explore the services we provide and find the one that suits your needs.</p>
        </div>

        <!-- Contact Tab -->
        <div class="tab-pane fade" id="contact" role="tabpanel">
            <h2>Contact</h2>
            <p>Get in touch with us for any inquiries or support.</p>
        </div>

    </div>
</div>

<div id="loader" style="display: none;">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>

<!-- Bootstrap 5.3 JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<!-- Bootstrap 5.3 JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<!-- SweetAlert2 JS -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<!-- Self Defined JavaScript -->
<script src="/js/common.js"></script>


</body>
</html>
